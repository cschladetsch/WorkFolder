#!/bin/bash
# Common functions
#
# Remember to export functions at the end,
# if you wish them to be used outside of this script.

export WORK_VERBOSE=1

echo_verbose()
{
    if [ $WORK_VERBOSE -ge "$1" ]; then
        shift
        echo "$*"
    fi
}

function gorepo()
{
    cur=$(pwd)
    repos_path="/w/repos/"
    repos=`find $repos_path -maxdepth 1 -type d`
    array=()

    echo -e "\e[95mGo to repo:\e[0m"
    count=0
    for var in $repos
    do
        cd "$var"
        if [ -d .git ]
        then
            array+=($var)
            name="`basename $var`"
            if [ $var == $cur ]
            then
                echo -e "\e[92m[$count] $name\e[0m"
            else
                echo -e "\e[34m[$count]\e[0m $name"
            fi
            ((count++))
        fi
    done
    read -rsn1 input
    dest=${array[input]}
    echo -e "\e[96mGoing to â†’ $dest\e[0m"
    cd "$dest"
}

gacp()
{
    if [ "$*" == "" ]; then
        echo "Need commit message"
        exit 1
    fi
    git add *
    git commit -m "$*"
    git push
}

unity_log()
{
    tail $* ~/AppData/Local/Unity/Editor/Editor.log
}

f()
{
    find . -name $*
}

help()
{
    echo start $WORK_DIR/doc/Readme.md
    start $WORK_DIR/doc/Readme.md
}

# Export functions
export gacp f help unity_log gorepo

echo_verbose 2 "...functions"

